"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[9433],{55980:(e,t,n)=>{n.d(t,{A:()=>r});n(65043);var a=n(75105),s=n(23930),l=n(83003),i=n(25878),o=n(70579);const r=e=>{let{open:t}=e;const n=(0,l.wA)();return(0,o.jsx)("div",{className:"item__modal",children:(0,o.jsxs)(a.A,{open:t,size:600,onClose:()=>{n((0,i.L)(!1)),window.location.reload()},children:[(0,o.jsx)(a.A.Header,{children:(0,o.jsx)("h6",{className:"py-2",children:"Add Item"})}),(0,o.jsx)(a.A.Body,{children:(0,o.jsx)(s.AddItemComponent,{})})]})})}},19983:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(83003);const s=e=>{const t=(0,a.d4)((e=>e.userDetail)),n=t.activeCompany;if(t.companies)for(let a of t.companies)if(a._id===n)return"invoice"===e?[a.invoiceInitial,a.invoiceNextCount]:"po"===e?[a.poInitial,a.poNextCount]:"proforma"===e?[a.proformaInitial,a.proformaNextCount]:"quotation"===e?[a.quotationInitial,a.quotationCount]:"creditnote"===e?[a.creditNoteInitial,a.creditNoteCount]:"salesreturn"===e?[a.salesReturnInitial,a.salesReturnCount]:"deliverychalan"===e?[a.deliverChalanInitial,a.deliveryChalanCount]:"purchase"===e?[a.purchaseInitial,a.purchaseNextCount]:null}},75532:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(89379),s=n(88918);const l=()=>{const{getApiData:e}=(0,s.A)(),t=(e,t)=>{const n=t[e].tax/100;return((t[e].qun*t[e].price-t[e].discountPerAmount)*n).toFixed(2)};return{onItemChange:async(t,n,a,s,l,i,o)=>{var r;if((null===(r=s[n])||void 0===r?void 0:r.itemId)===t)return;let d=(await e("item")).data.filter((e=>e._id===t));if(d.length>=0){var c,u,x,p,m,h,f,j,g,v,A,y,b,N,w;let e=[...s];console.log("lengthOfItem",e.length);let t=[],i=(null===(c=d[0])||void 0===c||null===(u=c.category)||void 0===u?void 0:u.tax)||(null===(x=d[0])||void 0===x?void 0:x.tax);const r=a.filter(((e,t)=>e._id===i))[0];e[n].itemName=null===(p=d[0])||void 0===p?void 0:p.title,e[n].itemId=null===(m=d[0])||void 0===m?void 0:m._id,e[n].hsn=(null===(h=d[0])||void 0===h||null===(f=h.category)||void 0===f?void 0:f.hsn)||(null===(j=d[0])||void 0===j?void 0:j.hsn),e[n].unit=null===(g=d[0])||void 0===g?void 0:g.unit,e[n].price="sale"===o?null===(v=d[0])||void 0===v?void 0:v.salePrice:null===(A=d[0])||void 0===A?void 0:A.purchasePrice,e[n].selectedUnit=null===(y=d[0])||void 0===y||null===(b=y.unit[0])||void 0===b?void 0:b.unit,e[n].tax=null!==(N=null===r||void 0===r?void 0:r.gst)&&void 0!==N?N:0,null===(w=d[0])||void 0===w||w.unit.forEach(((e,n)=>{t.push(e.unit)})),e[n].unit=[...t],l(e)}},addItem:(e,t,n,s,l,i)=>{1===e?(console.log("itemRowSet",t.length),n((e=>{const n=(0,a.A)((0,a.A)({},t),{},{rowItem:e.length>0?e[e.length-1].rowItem+1:t.rowItem}),l=[...e,n];return s((e=>(0,a.A)((0,a.A)({},e),{},{items:l}))),l}))):i((e=>{const t=(0,a.A)((0,a.A)({},l),{},{additionalRowsItem:e.length>0?e[e.length-1].additionalRowsItem+1:l.additionalRowsItem}),n=[...e,t];return s((e=>(0,a.A)((0,a.A)({},e),{},{additionalCharge:n}))),n}))},deleteItem:(e,t,n,s,l)=>{1===e?n((e=>{const n=e.filter(((e,n)=>n!==t));return s((e=>(0,a.A)((0,a.A)({},e),{},{items:n}))),n})):l((e=>{const n=e.filter(((e,n)=>n!==t));return s((e=>(0,a.A)((0,a.A)({},e),{},{additionalCharge:n}))),n}))},changeDiscountType:(e,t,n,s,l,i)=>{if("no"!==e.target.value){if("before"===e.target.value&&t.some((e=>parseInt(e.discountPerAmount)>0)))return void i("To apply discount before tax, remove discount on item","warning");s((0,a.A)((0,a.A)({},n),{},{discountType:e.target.value})),l(!1)}else s((0,a.A)((0,a.A)({},n),{},{discountType:e.target.value})),s((e=>(0,a.A)((0,a.A)({},e),{},{discountAmount:(0).toFixed(2),discountPercentage:(0).toFixed(2)}))),l(!0)},calculateFinalAmount:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0",i=0,o=0;if(e.forEach(((e,t)=>{e.amount&&(i+=parseFloat(e.amount))})),"no"===t.discountType||""===t.discountType||"before"===t.discountType?o=n()("amount"):"after"===t.discountType&&(o=(n()("amount")-t.discountAmount).toFixed(2)),a)return isNaN(i)?o:(parseFloat(i)+parseFloat(o)).toFixed(0);{let e=isNaN(i)?o:(parseFloat(i)+parseFloat(o)).toFixed(2);return s&&(e="0"===l?parseFloat(e)-parseFloat(s):parseFloat(e)+parseFloat(s)),e}},onPerDiscountAmountChange:(e,t,n,a,s)=>{let l=[...n],i=parseFloat(l[t].price)*parseFloat(l[t].qun),o=(parseFloat(e)/i*100).toFixed(2);"percentage"===l[t].perDiscountType&&"before"!==s.discountType||(l[t].discountPerAmount=isNaN(e)||0===e?(0).toFixed(2):e,l[t].discountPerPercentage=isNaN(o)?(0).toFixed(2):o),a(l)},onPerDiscountPercentageChange:(e,t,n,a,s)=>{let l=[...n],i=parseFloat(l[t].price)*parseFloat(l[t].qun)/100*e;"amount"===l[t].perDiscountType&&"before"!==s.discountType||(l[t].discountPerPercentage=e,l[t].discountPerAmount=i.toFixed(2)),a(l)},calculatePerTaxAmount:t,calculatePerAmount:(e,n)=>{const a=n[e].qun,s=n[e].price,l=n[e].discountPerAmount;return(parseFloat(a*s-l)+parseFloat(t(e,n))).toFixed(2)},onDiscountAmountChange:(e,t,n,s,l)=>{if(null!==t){let t=((e.target.value||(0).toFixed(2))/l()("amount")*100).toFixed(2);s((0,a.A)((0,a.A)({},n),{},{discountAmount:e.target.value,discountPercentage:t}))}}}}},99433:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(89379),s=n(65043),l=n(35543),i=n(44074),o=n(75206),r=n(86319),d=n(47196),c=n(6720),u=n(9435),x=n(88918),p=n(19983),m=n(1880),h=n(66580),f=n(83003),j=(n(91887),n(25878),n(73023)),g=n.n(j),v=n(60309),A=n(55980),y=n(89771),b=n(53435),N=n(75532),w=n(70579);document.title="Purchase Invoice";const P=e=>{var t,n;let{mode:j}=e;const P=(0,u.A)(),{id:F}=(0,h.g)(),{getApiData:T}=((0,p.A)("invoice"),(0,x.A)()),C=(0,f.d4)((e=>e.partyModalSlice.show)),I=(0,f.d4)((e=>e.itemModalSlice.show)),S=((0,f.wA)(),(0,h.Zp)()),_={rowItem:1,itemName:"",description:"",hsn:"",qun:"1",itemId:"",unit:[],selectedUnit:"",price:"",discountPerAmount:"",discountPerPercentage:"",tax:"",taxAmount:"",amount:"",perDiscountType:""},O={additionalRowsItem:1,particular:"",amount:""},[D,R]=(0,s.useState)([_]),[k,q]=(0,s.useState)([O]),[E,U]=(0,s.useState)({party:"",purchaseReturnNumber:"",returnDate:(new Date).toISOString().split("T")[0],items:D,additionalCharge:k,note:"",terms:"",discountType:"",discountAmount:"",discountPercentage:"",finalAmount:"",autoRoundOff:!1,roundOffAmount:null,roundOffType:"0",returnInvoiceNumber:""}),[z,H]=(0,s.useState)(null),[K,Y]=(0,s.useState)(null),[J,B]=(0,s.useState)(null),[M,Q]=(0,s.useState)(null),[$,L]=(0,s.useState)(null),[Z,G]=(0,s.useState)([]),[V,W]=(0,s.useState)([]),[X,ee]=(0,s.useState)(!0),[te,ne]=(0,s.useState)([]),[ae,se]=(0,s.useState)([]),[le,ie]=(0,s.useState)([]),[oe,re]=(0,s.useState)([]),[de,ce]=(0,s.useState)([]),[ue,xe]=(0,s.useState)([]),{onItemChange:pe,addItem:me,deleteItem:he,changeDiscountType:fe,calculateFinalAmount:je}=(0,N.A)();(0,s.useEffect)((()=>{if(j){(async()=>{try{const e="".concat("https://ezy-bill-api.tisindia.net/api/v1","/purchasereturn/get"),t=m.A.get("token"),n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,id:F})}),s=await n.json();U((0,a.A)((0,a.A)({},E),s.data)),q([...s.data.additionalCharge]),R([...s.data.items]),"no"!=s.data.discountType&&ee(!1)}catch(e){console.log(e),P("Data not get something went wrong","error")}})()}}),[j]),(0,s.useEffect)((()=>{(async()=>{if(E.party){const{data:e}=await T("party",E.party);L(e)}})()}),[E.party]),(0,s.useState)((()=>{(async()=>{{const e=await T("item");ne([...e.data]),console.log(e.data);const t=e.data.map((e=>({label:e.title,value:e.title})));ce(t)}{const e=(await T("unit")).data.map((e=>({label:e.title,value:e.title})));se([...e])}{const e=await T("tax"),t=e.data.map((e=>({label:e.title,value:e.gst})));ie([...e.data]),xe([...t])}{const e=(await T("party")).data.map((e=>({label:e.name,value:e._id})));re([...e])}})()}),[]),(0,s.useEffect)((()=>{"before"===E.discountType&&D.length>0&&R((e=>e.map((t=>{const n=(parseFloat(E.discountAmount||0)/parseFloat(t.price||0)*100).toFixed(2),s=(parseFloat(E.discountAmount||0)/parseFloat(e.length)).toFixed(2);return(0,a.A)((0,a.A)({},t),{},{discountPerPercentage:n,discountPerAmount:s})}))))}),[E.discountAmount,D.length]);const ge=(e,t)=>{let n=[...D],a=parseFloat(n[t].price)*parseFloat(n[t].qun),s=(parseFloat(e)/a*100).toFixed(2);"percentage"===n[t].perDiscountType&&"before"!==E.discountType||(n[t].discountPerAmount=isNaN(e)||0===e?(0).toFixed(2):e,n[t].discountPerPercentage=isNaN(s)?(0).toFixed(2):s),R(n)},ve=(e,t)=>{let n=[...D],a=parseFloat(n[t].price)*parseFloat(n[t].qun)/100*e;"amount"===n[t].perDiscountType&&"before"!==E.discountType||(n[t].discountPerPercentage=e,n[t].discountPerAmount=a.toFixed(2)),R(n)},Ae=e=>{const t=D[e].tax/100;return((D[e].qun*D[e].price-D[e].discountPerAmount)*t).toFixed(2)},ye=e=>{const t=D[e].qun,n=D[e].price,a=D[e].discountPerAmount;return(parseFloat(t*n-a)+parseFloat(Ae(e))).toFixed(2)};(0,s.useEffect)((()=>{const e=je(k,E,be,E.autoRoundOff,E.roundOffAmount,E.roundOffType);U((t=>(0,a.A)((0,a.A)({},t),{},{finalAmount:e})))}),[D,k,E.autoRoundOff,E.roundOffAmount,E.roundOffType]);const be=(0,s.useCallback)((()=>e=>{let t=0;return D.forEach(((n,a)=>{"discount"===e?n.discountPerAmount&&(t=(parseFloat(t)+parseFloat(n.discountPerAmount)).toFixed(2)):"tax"===e?t=(parseFloat(t)+parseFloat(Ae(a))).toFixed(2):"amount"===e&&(t=(parseFloat(t)+parseFloat(ye(a))).toFixed(2))})),isNaN(t)?0:t}),[D,z,K,J,M]),Ne=()=>{R([_]),q([O]),U({party:"",purchaseReturnNumber:"",returnDate:(new Date).toISOString().split("T")[0],items:D,additionalCharge:k,note:"",terms:"",discountType:"",discountAmount:"",discountPercentage:"",finalAmount:"",autoRoundOff:!1,roundOffAmount:null,roundOffType:"0",returnInvoiceNumber:""})};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(o.A,{title:"edit"==j?"Update Purchase Return":"Add Purchase Return"}),(0,w.jsxs)("main",{id:"main",children:[(0,w.jsx)(r.A,{}),(0,w.jsx)(v.A,{open:C}),(0,w.jsx)(A.A,{open:I}),(0,w.jsx)("div",{className:"content__body",children:(0,w.jsxs)("div",{className:"content__body__main bg-white",id:"addQuotationTable",children:[(0,w.jsx)("div",{className:"top__btn__grp",children:(0,w.jsx)("div",{className:"extra__btns",children:"edit"===j&&(0,w.jsxs)("button",{onClick:()=>{g()({title:"Are you sure?",icon:"warning",buttons:!0}).then((e=>{e&&(g()("Invoice successfully duplicate",{icon:"success"}),S("/admin/purchase-return/add/".concat(F)))}))},children:[(0,w.jsx)(b.F.COPY,{}),"Duplicate invoice"]})})}),(0,w.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-around gap-4",children:[(0,w.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:max-w-[425px]",children:[(0,w.jsxs)("p",{className:"text-xs",children:["Select Party ",(0,w.jsx)("span",{className:"required__text",children:"*"})]}),(0,w.jsx)(y.A,{model:"party",partyType:"supplier",onType:e=>{U((0,a.A)((0,a.A)({},E),{},{party:e})),(async e=>{(async()=>{try{const t="".concat("https://ezy-bill-api.tisindia.net/api/v1","/purchaseinvoice/get-party-invoice"),n=m.A.get("token"),a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n,partyId:e})}),s=await a.json();if(200!==a.status||s.err)return P(s.err,"error");const l=s.map((e=>({label:e.purchaseInvoiceNumber,value:e.purchaseInvoiceNumber})));G(l),W(s)}catch(t){return console.log(t),P("Something went wrong","error")}})()})(e)},value:null===(t=E.party)||void 0===t?void 0:t._id})]}),(0,w.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,w.jsxs)("p",{className:"text-xs",children:["Select Purchase Invoice ",(0,w.jsx)("span",{className:"required__text",children:"*"})]}),(0,w.jsx)(l.A,{searchable:!0,data:Z,value:null===(n=E.returnInvoiceNumber)||void 0===n?void 0:n.value,onChange:e=>{if(e){const t=V.find((t=>t.purchaseInvoiceNumber===e)),n=Z.find(((t,n)=>t.value===e));U((0,a.A)((0,a.A)((0,a.A)({},E),t),{},{returnInvoiceNumber:n})),q([...t.additionalCharge]),R([...t.items])}else Ne()}})]}),(0,w.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,w.jsxs)("p",{className:"text-xs",children:["Purchase Return Number ",(0,w.jsx)("span",{className:"required__text",children:"*"})]}),(0,w.jsx)("input",{type:"text",onChange:e=>U((0,a.A)((0,a.A)({},E),{},{purchaseReturnNumber:e.target.value})),value:E.purchaseReturnNumber})]}),(0,w.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,w.jsxs)("p",{className:"text-xs",children:["Return Date ",(0,w.jsx)("span",{className:"required__text",children:"*"})]}),(0,w.jsx)("input",{type:"date",className:"text-xs",onChange:e=>{U((0,a.A)((0,a.A)({},E),{},{returnDate:e.target.value}))},value:E.returnDate})]})]}),null!==$&&(0,w.jsxs)("div",{className:"text-[10px] mt-2",children:[(0,w.jsxs)("p",{children:[(0,w.jsx)("span",{className:"font-semibold",children:"Phone"}),": ",null===$||void 0===$?void 0:$.contactNumber]}),(0,w.jsxs)("p",{children:[(0,w.jsx)("span",{className:"font-semibold",children:"Address"}),": ",null===$||void 0===$?void 0:$.billingAddress]})]}),(0,w.jsx)("div",{className:"overflow-x-auto rounded",children:(0,w.jsxs)("table",{className:"add__table min-w-full table-style",children:[(0,w.jsx)("thead",{children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("th",{style:{width:"*"},children:"Item"}),(0,w.jsx)("th",{style:{width:"6%"},children:"HSN/SAC"}),(0,w.jsx)("th",{style:{width:"5%"},children:"QTY"}),(0,w.jsx)("th",{style:{width:"7%"},children:"Unit"}),(0,w.jsx)("th",{style:{width:"10%"},children:"Price/Item"}),(0,w.jsx)("th",{style:{width:"10%"},children:"Discount"}),(0,w.jsx)("th",{style:{width:"10%"},children:"Tax"}),(0,w.jsx)("th",{style:{width:"10%"},children:"Amount"}),(0,w.jsx)("th",{style:{width:"3%"}})]})}),(0,w.jsx)("tbody",{children:D.map(((e,t)=>(0,w.jsxs)("tr",{className:"border-b",children:[(0,w.jsx)("td",{children:(0,w.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,w.jsx)(y.A,{model:"item",onType:e=>pe(e,t,le,D,R,ne),value:D[t].itemId}),(0,w.jsx)("input",{type:"text",className:"input-style",placeholder:"Description",onChange:e=>{let n=[...D];n[t].description=e.target.value,R(n)},value:D[t].description})]})}),(0,w.jsx)("td",{children:(0,w.jsx)("input",{type:"text",className:"w-[70px] input-style",onChange:e=>{let n=[...D];n[t].hsn=e.target.value,R(n)},value:D[t].hsn})}),(0,w.jsx)("td",{children:(0,w.jsx)("input",{type:"text",className:"input-style",onChange:e=>{let n=[...D];n[t].qun=e.target.value,R(n),Q(e.target.value),E.discountType,ve(E.items[t].discountPerPercentage,t),ge(E.items[t].discountPerAmount,t)},value:D[t].qun})}),(0,w.jsx)("td",{children:(0,w.jsx)("select",{className:"input-style",onChange:e=>{let n=[...D];n[t].selectedUnit=e.target.value,R(n)},value:D[t].selectedUnit,children:D[t].unit.map(((e,t)=>(0,w.jsx)("option",{value:e,children:e},t)))})}),(0,w.jsx)("td",{align:"center",children:(0,w.jsx)("div",{children:(0,w.jsx)("input",{type:"text",className:"input-style",onChange:e=>{let n=[...D];n[t].price=e.target.value,R(n),H(e.target.value),E.discountType,ve(E.items[t].discountPerPercentage,t),ge(E.items[t].discountPerAmount,t)},value:D[t].price})})}),(0,w.jsxs)("td",{children:[" ",(0,w.jsxs)("div",{className:"w-[100px] flex flex-col gap-2 items-center",children:[(0,w.jsxs)("div",{className:"add-table-discount-input",children:[(0,w.jsx)("input",{type:"text",className:"".concat("before"===E.discountType?"bg-gray-100":""," "),onChange:"before"!==E.discountType?e=>{let n=(0,a.A)({},E);n.items[t].perDiscountType="amount",U((0,a.A)({},n)),ge(e.target.value,t)}:null,value:D[t].discountPerAmount}),(0,w.jsx)("div",{children:(0,w.jsx)(c.YHz,{})})]}),(0,w.jsxs)("div",{className:"add-table-discount-input",children:[(0,w.jsx)("input",{type:"text",className:"".concat("before"===E.discountType?"bg-gray-100":""," "),onChange:"before"!==E.discountType?e=>{let n=(0,a.A)({},E);n.items[t].perDiscountType="percentage",U((0,a.A)({},n)),ve(e.target.value,t)}:null,value:D[t].discountPerPercentage}),(0,w.jsx)("div",{children:"%"})]})]})]}),(0,w.jsxs)("td",{children:[" ",(0,w.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,w.jsx)(l.A,{onChange:e=>{let n=[...D];n[t].tax=e,R(n),Y("")},value:D[t].tax,data:ue}),(0,w.jsx)("input",{type:"text",onChange:e=>{let n=[...D];n[t].taxAmount=e.target.value,R(n)},value:Ae(t)})]})]}),(0,w.jsx)("td",{align:"center",children:(0,w.jsx)("div",{children:(0,w.jsx)("input",{type:"text",value:ye(t),className:"bg-gray-100 custom-disabled",disabled:!0})})}),(0,w.jsx)("td",{align:"center",className:"w-[20px]",children:(0,w.jsx)(d.Ku6,{className:"cursor-pointer text-[16px]",onClick:()=>D.length>1&&he(1,t,R,U,q)})})]},e.rowItem)))}),(0,w.jsxs)("tfoot",{children:[(0,w.jsx)("tr",{children:(0,w.jsx)("td",{colSpan:9,children:(0,w.jsxs)(i.A,{color:"blue",className:"float-right w-full font-bold",onClick:()=>me(1,_,R,U,O,q),children:[(0,w.jsx)(c.$K2,{className:"text-lg mr-1"}),"Add Item"]})})}),(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{colSpan:5,align:"right",children:(0,w.jsx)("p",{className:"py-2 font-bold",children:"Sub-Total"})}),(0,w.jsx)("td",{children:be()("discount")}),(0,w.jsx)("td",{children:be()("tax")}),(0,w.jsx)("td",{children:be()("amount")})]})]})]})}),(0,w.jsx)("div",{className:"overflow-x-auto rounded",id:"taxAmountTable",children:(0,w.jsxs)("table",{className:"table-style w-full",children:[(0,w.jsx)("thead",{children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{className:"font-bold",children:"Total Taxable Amount"}),(0,w.jsx)("td",{className:"font-bold",children:"Total Tax Amount"}),(0,w.jsxs)("td",{children:[(0,w.jsx)("span",{className:"font-bold mr-1",children:"Discount Type"}),(0,w.jsx)("span",{children:"(Additional)"})]}),(0,w.jsxs)("td",{children:[(0,w.jsx)("span",{className:"font-bold mr-1",children:"Discount Amount"}),(0,w.jsx)("span",{children:"(Additional)"})]}),(0,w.jsxs)("td",{children:[(0,w.jsx)("span",{className:"font-bold mr-1",children:"Discount Percentage"}),(0,w.jsx)("span",{children:"(Additional)"})]}),(0,w.jsx)("td",{className:"font-bold",children:"Total Amount"})]})}),(0,w.jsx)("tbody",{children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{className:"min-w-[150px]",children:(0,w.jsx)("input",{type:"text",name:"total_taxable_amount",value:(be()("amount")-be()("tax")).toFixed(2),className:"bg-gray-100 custom-disabled",disabled:!0})}),(0,w.jsx)("td",{className:"min-w-[150px]",children:(0,w.jsx)("input",{type:"text",name:"total_tax_amount",value:be()("tax"),className:"bg-gray-100 custom-disabled",disabled:!0})}),(0,w.jsx)("td",{className:"min-w-[180px]",children:(0,w.jsxs)("select",{name:"discount_type",value:E.discountType,onChange:e=>{fe(e,D,E,U,ee,P)},children:[(0,w.jsx)("option",{value:"no",children:"No Discount"}),(0,w.jsx)("option",{value:"before",children:"Before Tax"}),(0,w.jsx)("option",{value:"after",children:"After Tax"})]})}),(0,w.jsx)("td",{className:"min-w-[180px]",children:(0,w.jsxs)("div",{className:"add-table-discount-input",children:[(0,w.jsx)("input",{id:"discountAmount",type:"text",className:"".concat(X?"bg-gray-100 custom-disabled":""),disabled:!!X,onChange:e=>X?null:(e=>{if(null!==X){let t=((e.target.value||(0).toFixed(2))/be()("amount")*100).toFixed(2);U((0,a.A)((0,a.A)({},E),{},{discountAmount:e.target.value,discountPercentage:t}))}})(e),value:E.discountAmount}),(0,w.jsx)("div",{children:(0,w.jsx)(c.YHz,{})})]})}),(0,w.jsx)("td",{className:"min-w-[200px]",children:(0,w.jsxs)("div",{className:"add-table-discount-input",children:[(0,w.jsx)("input",{type:"text",id:"discountPercentage",className:"".concat(X?"bg-gray-100 custom-disabled":""),disabled:!!X,onChange:X?null:e=>{let t=(be()("amount")/100*e.target.value).toFixed(2);if(U((0,a.A)((0,a.A)({},E),{},{discountPercentage:e.target.value,discountAmount:t})),"before"===E.discountType){let t=[...D];t.forEach(((t,n)=>{t.discountPerPercentage=e.target.value})),R([...t])}},value:E.discountPercentage}),(0,w.jsx)("div",{children:"%"})]})}),(0,w.jsx)("td",{className:"min-w-[150px]",children:(0,w.jsx)("input",{type:"text",name:"total_amount",className:"bg-gray-100 custom-disabled",disabled:!0,value:be()("amount")})})]})})]})}),(0,w.jsxs)("div",{className:"w-full flex flex-col lg:flex-row justify-between gap-4 mt-3",children:[(0,w.jsxs)("div",{className:"flex flex-col w-full gap-3",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{children:"Note: "}),(0,w.jsx)("input",{type:"text",onChange:e=>U((0,a.A)((0,a.A)({},E),{},{note:e.target.value})),value:E.note})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{children:"Terms:"}),(0,w.jsx)("input",{type:"text",onChange:e=>U((0,a.A)((0,a.A)({},E),{},{terms:e.target.value})),value:E.terms})]})]}),(0,w.jsxs)("div",{className:"w-full",children:[(0,w.jsx)("div",{className:"uppercase font-bold border border-dashed p-2 rounded",children:"Additional Charges"}),(0,w.jsx)("div",{className:"overflow-x-auto rounded mt-3",id:"addtionalChargeTable",children:(0,w.jsxs)("table",{className:"table-style w-full",children:[(0,w.jsx)("thead",{className:"bg-gray-100",children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{children:"Particular"}),(0,w.jsx)("td",{children:"Amount"}),(0,w.jsx)("td",{children:"Actions"})]})}),(0,w.jsx)("tbody",{children:k.map(((e,t)=>(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{children:(0,w.jsx)("input",{type:"text",onChange:e=>{let n=[...k];n[t].particular=e.target.value,q(n)},value:k[t].particular})}),(0,w.jsx)("td",{children:(0,w.jsx)("input",{type:"text",onChange:e=>{let n=[...k];n[t].amount=e.target.value,q(n)},value:k[t].amount})}),(0,w.jsx)("td",{align:"center",children:(0,w.jsx)(d.Ku6,{className:"cursor-pointer text-lg",onClick:()=>he(2,t,R,U,q)})})]},e.additionalRowsItem)))}),(0,w.jsx)("tfoot",{children:(0,w.jsx)("tr",{children:(0,w.jsx)("td",{colSpan:3,children:(0,w.jsxs)(i.A,{color:"blue",className:"float-right w-full font-bold",onClick:()=>me(2,_,R,U,O,q),children:[(0,w.jsx)(c.$K2,{className:"text-lg mr-1"}),"Add Item"]})})})})]})}),(0,w.jsxs)("div",{className:"flex justify-between items-center w-full mt-4 round__off__section",children:[(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)("input",{type:"checkbox",onChange:e=>U((0,a.A)((0,a.A)({},E),{},{autoRoundOff:e.target.checked})),checked:E.autoRoundOff}),(0,w.jsx)("p",{children:"Auto Round Off"})]}),!E.autoRoundOff&&(0,w.jsx)("div",{children:(0,w.jsxs)("div",{className:"flex items-center text-sm",children:[(0,w.jsxs)("button",{onClick:()=>{U((0,a.A)((0,a.A)({},E),{},{roundOffType:"1"}))},className:"flex items-center text-[10px] border ".concat("1"===E.roundOffType?"border-blue-700":""," p-[2px]"),children:["Add ",(0,w.jsx)("span",{children:"(+)"})]}),(0,w.jsx)("input",{type:"text",className:"w-[100px]",value:E.roundOffAmount,onChange:e=>U((0,a.A)((0,a.A)({},E),{},{roundOffAmount:e.target.value}))}),(0,w.jsxs)("button",{onClick:()=>{U((0,a.A)((0,a.A)({},E),{},{roundOffType:"0"}))},className:"flex items-center text-[10px] border ".concat("0"===E.roundOffType?"border-blue-700":""," p-[2px]"),children:["Reduce ",(0,w.jsx)("span",{children:"(-)"})]})]})})]}),(0,w.jsx)("p",{className:"font-bold mt-4 mb-2",children:"Final Amount"}),(0,w.jsx)("input",{type:"text",name:"final_amount",className:"bg-gray-100 custom-disabled w-full",disabled:!0,value:E.finalAmount})]})]}),(0,w.jsxs)("div",{className:"w-full flex justify-center gap-3 my-3 mt-5",children:[(0,w.jsxs)("button",{onClick:async()=>{if(""===E.party)return P("Please select party","error");if(""===E.purchaseReturnNumber)return P("Please enter purchase return number","error");if(""===E.returnDate)return P("Please select return date","error");for(let t of D){if(""===t.itemName)return P("Please select item","error");if(""===t.qun)return P("Please enter quantity","error");if(""===t.unit)return P("Please select unit","error");if(""===t.price)return P("Please enter price","error")}D.forEach(((e,t)=>{e.taxAmount=Ae(t),e.amount=ye(t)})),R([...D]);try{const e="https://ezy-bill-api.tisindia.net/api/v1/purchasereturn/add",t=m.A.get("token"),n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j&&"edit"===j?(0,a.A)((0,a.A)({},E),{},{token:t,update:!0,id:F}):(0,a.A)((0,a.A)({},E),{},{token:t}))}),s=await n.json();return 200!==n.status||s.err?P(s.err,"error"):"edit"===j?(P("Purchase Return update successfully","success"),void S(-1)):(Ne(),P("Purchase Return add successfully","success"),void S("/admin/purchase-return"))}catch(e){return console.log(e),P("Something went wrong","error")}},className:"add-bill-btn",children:[(0,w.jsx)(b.F.CHECK,{}),j&&"convert"!==j?"Update":"Save"]}),(0,w.jsxs)("button",{className:"reset-bill-btn",onClick:Ne,children:[(0,w.jsx)(b.F.RESET,{}),"Reset"]})]})]})})]})]})}}}]);
//# sourceMappingURL=9433.bc60933b.chunk.js.map