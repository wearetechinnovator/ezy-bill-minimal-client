"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[7401,7801],{3601:(e,t,a)=>{a.r(t),a.d(t,{AddPaymentOutComponent:()=>y,default:()=>f});var n=a(89379),s=a(65043),r=a(75206),c=a(86319),l=a(35543),o=a(88918),i=a(9435),d=a(1880),m=a(66580),u=a(89771),p=a(53435),h=a(70579);const y=e=>{let{mode:t,partyId:a,invoiceNumber:r,due:c}=e;const{getApiData:y}=(0,o.A)(),f=(0,i.A)(),{id:x}=(0,m.g)(),[v,j]=(0,s.useState)({party:a||"",paymentOutNumber:"",paymentOutDate:"",paymentMode:"",account:"",amount:"",details:"",invoiceId:r||""}),[A,N]=(0,s.useState)(c),[g,b]=(0,s.useState)([]),[w,_]=(0,s.useState)([]),D=(0,m.Zp)(),[P,S]=(0,s.useState)([]);let[C,k]=(0,s.useState)([]),[O,E]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(v.amount){let e=0;for(const a of C)e+=parseInt(a.dueAmount,10);const t=parseInt(v.amount,10)-e;E(t)}}),[v.amount,C]),(0,s.useEffect)((()=>{(async()=>{try{const e="https://ezy-bill-api.tisindia.net/api/v1/purchaseinvoice/get",t=d.A.get("token"),a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,invoice:!0,party:v.party})}),n=await a.json(),s=n.data.map((e=>({value:e.purchaseInvoiceNumber,label:e.purchaseInvoiceNumber,due:e.dueAmount})));S([...n.data]),console.log(n.data),_([...s])}catch(e){return console.log(e),f("Something went wrong","error")}})()}),[v.party]),(0,s.useEffect)((()=>{if(t){(async()=>{const e=await y("paymentout",x);j((0,n.A)((0,n.A)((0,n.A)({},v),e.data),{},{paymentOutDate:e.data.paymentOutDate.split("T")[0]}))})()}}),[t]),(0,s.useEffect)((()=>{(async()=>{{const e=(await y("account")).data.map((e=>({label:e.title,value:e._id})));b([...e])}})()}),[]);const I=()=>{j({party:"",paymentOutNumber:"",paymentOutDate:"",paymentMode:"",account:"",amount:"",details:""})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"content__body__main bg-white",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 lg:gap-4 gap-0",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Select Party"}),(0,h.jsx)(u.A,{model:"party",partyType:"supplier",onType:e=>{j((0,n.A)((0,n.A)({},v),{},{party:e}))},value:v.party})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Amount"}),(0,h.jsx)("input",{type:"text",value:v.amount,onChange:e=>j((0,n.A)((0,n.A)({},v),{},{amount:e.target.value}))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment out Number"}),(0,h.jsx)("input",{type:"text",value:v.paymentOutNumber,onChange:e=>j((0,n.A)((0,n.A)({},v),{},{paymentOutNumber:e.target.value}))})]})]}),(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment out Date"}),(0,h.jsx)("input",{type:"date",value:v.paymentOutDate,onChange:e=>{j((0,n.A)((0,n.A)({},v),{},{paymentOutDate:e.target.value}))},className:"w-full"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment Mode"}),(0,h.jsxs)("select",{name:"mode",id:"",value:v.paymentMode,onChange:e=>j((0,n.A)((0,n.A)({},v),{},{paymentMode:e.target.value})),children:[(0,h.jsx)("option",{value:"",children:"--Select--"}),(0,h.jsx)("option",{value:"cash",children:"Cash"}),(0,h.jsx)("option",{value:"bank",children:"Bank"}),(0,h.jsx)("option",{value:"cheque",children:"Cheque"})]})]}),"cash"!==v.paymentMode&&(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Account"}),(0,h.jsx)(l.A,{className:"w-full",data:g,onChange:e=>j((0,n.A)((0,n.A)({},v),{},{account:e})),value:v.account})]})]})]})}),(0,h.jsxs)("div",{className:"content__body__main mt-3",children:[(0,h.jsxs)("table",{className:"w-full border",children:[(0,h.jsx)("thead",{className:"bg-gray-200",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{}),(0,h.jsx)("td",{className:"p-2 font-medium",children:"Date"}),(0,h.jsx)("td",{className:"font-medium",children:"Invoice Number"}),(0,h.jsx)("td",{className:"font-medium",children:"Invoice Amount"}),(0,h.jsx)("td",{className:"font-medium",children:"TDS Amount"})]})}),(0,h.jsx)("tbody",{children:P.length>0?P.map(((e,t)=>(0,h.jsxs)("tr",{className:"border-gray-300",children:[(0,h.jsx)("td",{className:"p-2 max-w-2",children:(0,h.jsx)("input",{type:"checkbox",onChange:t=>((e,t)=>{const{checked:a}=e.target,s=parseInt(t.dueAmount);if(a){if(O<=0)return f("No amount left to allocate","error"),e.preventDefault(),void(e.target.checked=!1);const a=Math.min(O,s),r=[...C,(0,n.A)((0,n.A)({},t),{},{allocated:a})];k(r),E(O-a)}else{const e=C.find((e=>e._id===t._id)),a=C.filter((e=>e._id!==t._id));e&&E(O+e.allocated),k(a)}})(t,e)})}),(0,h.jsx)("td",{children:e.invoiceDate.split("T")[0]}),(0,h.jsx)("td",{children:e.purchaseInvoiceNumber}),(0,h.jsx)("td",{children:e.dueAmount||0}),(0,h.jsx)("td",{children:e.tdsAmount||0})]},t))):(0,h.jsx)("tr",{className:"text-center",children:(0,h.jsx)("td",{colSpan:5,className:"py-5 text-gray-500 font-bold",children:"No Invoice found"})})})]}),(0,h.jsxs)("div",{className:"w-full flex justify-end gap-3 mt-3",children:[(0,h.jsxs)("button",{onClick:async()=>{if(""===v.party)return f("Please select a party","error");if(""===v.paymentOutNumber)return f("Please enter a payment number","error");if(""===v.paymentOutDate)return f("Please select a payment date","error");if(""===v.paymentMode)return f("Please select a payment mode","error");if(""===v.account)return f("Please select an account","error");if(C.length<=0)return f("Select invoice","error");try{const e="https://ezy-bill-api.tisindia.net/api/v1/paymentout/add",a=d.A.get("token"),s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t?(0,n.A)((0,n.A)({},v),{},{token:a,update:!0,id:x,checkedInv:C}):(0,n.A)((0,n.A)({},v),{},{token:a,checkedInv:C}))}),r=await s.json();return 200!==s.status||r.err?f(r.err,"error"):t?(f("Payment update successfully","success"),void D(-1)):(I(),f("Payment add successfully","success"),void D("/admin/payment-out"))}catch(e){return console.log(e),f("Something went wrong","error")}},className:"bg-green-500 hover:bg-green-400 save__and__reset__btns",children:[(0,h.jsx)(p.F.CHECK,{}),t?"Update":"Save"]}),(0,h.jsxs)("button",{onClick:I,className:"bg-blue-800 hover:bg-blue-700 save__and__reset__btns",children:[(0,h.jsx)(p.F.RESET,{}),"Reset"]})]})]})]})},f=e=>{let{mode:t}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.A,{title:"Add Payment"}),(0,h.jsxs)("main",{id:"main",children:[(0,h.jsx)(c.A,{}),(0,h.jsx)("div",{className:"content__body",children:(0,h.jsx)(y,{mode:t})})]})]})}},7801:(e,t,a)=>{a.d(t,{A:()=>S});var n=a(53986),s=a(58168),r=a(65043),c=a(75180),l=a(45467),o=a(32949);const i=["timeout","placement"],d=r.forwardRef(((e,t)=>{let{timeout:a=300,placement:d="right"}=e,m=(0,n.A)(e,i);const{propsWithDefaults:u}=(0,o.l)("Slide",m),{prefix:p}=(0,l.U)("anim"),h=p("slide-in",d),y=p("slide-out",d);return r.createElement(c.A,(0,s.A)({},u,{ref:t,animation:!0,timeout:a,enteringClassName:h,enteredClassName:h,exitingClassName:y,exitedClassName:y}))}));d.displayName="Slide";const m=d;var u=a(75105);const p={};function h(e){p[e]||(console.warn(e),p[e]=!0)}h._resetWarned=()=>{for(const e in p)delete p[e]};const y=h;function f(e,t){var a;const n=null!==(a=e.displayName)&&void 0!==a?a:e.name,c=r.forwardRef(((a,n)=>(y(t),r.createElement(e,(0,s.A)({ref:n},a)))));return c.displayName="deprecated(".concat(n,")"),c}var x=a(21569);const v=r.forwardRef(((e,t)=>r.createElement(x.A,(0,s.A)({classPrefix:"drawer-body"},e,{ref:t}))));var j=a(92024);const A=r.forwardRef(((e,t)=>r.createElement(j.A,(0,s.A)({classPrefix:"drawer-header"},e,{ref:t}))));const N=(0,a(43574).a)({name:"DrawerActions"});var g=a(68558);const b=r.forwardRef(((e,t)=>r.createElement(g.A,(0,s.A)({classPrefix:"drawer-footer"},e,{ref:t}))));var w=a(28307);const _=r.forwardRef(((e,t)=>r.createElement(w.A,(0,s.A)({classPrefix:"drawer-title"},e,{ref:t})))),D=["className","placement","classPrefix","animation","closeButton"],P=r.forwardRef(((e,t)=>{const{propsWithDefaults:a}=(0,o.l)("Drawer",e),{className:c,placement:i="right",classPrefix:d="drawer",animation:p=m,closeButton:h=!0}=a,y=(0,n.A)(a,D),{merge:f,prefix:x}=(0,l.U)(d),v=f(c,x(i)),j={placement:i};return r.createElement(u.A,(0,s.A)({},y,{ref:t,overflow:!1,classPrefix:d,className:v,animation:p,animationProps:j,isDrawer:!0,closeButton:h}))}));v.displayName="DrawerBody",A.displayName="DrawerHeader",N.displayName="DrawerActions",b.displayName="DrawerFooter",_.displayName="DrawerTitle",P.Body=v,P.Header=A,P.Actions=N,P.Footer=f(b,"<Drawer.Footer> has been deprecated, use <Drawer.Actions> instead."),P.Title=_,P.displayName="Drawer";const S=P}}]);
//# sourceMappingURL=7401.b13c964c.chunk.js.map