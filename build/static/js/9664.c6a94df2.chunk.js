"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[7801,9664],{37614:(e,a,t)=>{t.r(a),t.d(a,{AddPaymentInComponent:()=>y,default:()=>f});var n=t(89379),s=t(65043),r=t(75206),l=t(86319),c=t(35543),i=t(88918),o=t(9435),d=t(1880),m=t(66580),u=t(89771),p=t(53435),h=t(70579);const y=e=>{let{mode:a,partyId:t,invoiceNumber:r,due:l}=e;const y=(0,m.Zp)(),{getApiData:f}=(0,i.A)(),x=(0,o.A)(),{id:v}=(0,m.g)(),[j,A]=(0,s.useState)({party:t||"",paymentInNumber:"",paymentInDate:"",paymentMode:"",account:"",amount:"",details:"",invoiceId:""}),[N,g]=(0,s.useState)([]),[b,w]=(0,s.useState)([]),[_,I]=(0,s.useState)([]);let[D,P]=(0,s.useState)([]),[C,S]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(j.amount){let e=0;for(const t of D)e+=parseInt(t.dueAmount,10);const a=parseInt(j.amount,10)-e;S(a)}}),[j.amount,D]),(0,s.useEffect)((()=>{(async()=>{try{const e="https://ezy-bill-api.tisindia.net/api/v1/salesinvoice/get",a=d.A.get("token"),t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,invoice:!0,party:j.party})}),n=await t.json(),s=n.data.map((e=>({value:e.salesInvoiceNumber,label:e.salesInvoiceNumber,due:e.dueAmount})));console.log(n.data),I([...n.data]),w([...s])}catch(e){return console.log(e),x("Something went wrong","error")}})()}),[j.party]),(0,s.useEffect)((()=>{if(a){(async()=>{const e=await f("paymentin",v);A((0,n.A)((0,n.A)((0,n.A)({},j),e.data),{},{paymentInDate:e.data.paymentInDate.split("T")[0]}))})()}}),[a]),(0,s.useEffect)((()=>{(async()=>{{const e=(await f("account")).data.map((e=>({label:e.title,value:e._id})));g([...e])}})()}),[]);const k=()=>{A({party:"",paymentInNumber:"",paymentInDate:"",paymentMode:"",account:"",amount:"",details:"",invoiceId:""})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"content__body__main bg-white",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 lg:gap-4 gap-0",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Select Party"}),(0,h.jsx)(u.A,{model:"party",partyType:"customer",onType:e=>{A((0,n.A)((0,n.A)({},j),{},{party:e}))},value:j.party})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Amount"}),(0,h.jsx)("input",{type:"text",value:j.amount,onChange:D.length>0?null:e=>A((0,n.A)((0,n.A)({},j),{},{amount:e.target.value}))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment in Number"}),(0,h.jsx)("input",{type:"text",value:j.paymentInNumber,onChange:e=>A((0,n.A)((0,n.A)({},j),{},{paymentInNumber:e.target.value}))})]})]}),(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment in Date"}),(0,h.jsx)("input",{type:"date",onChange:e=>{A((0,n.A)((0,n.A)({},j),{},{paymentInDate:e.target.value}))},value:j.paymentInDate,className:"w-full"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Payment Mode"}),(0,h.jsxs)("select",{name:"mode",id:"",value:j.paymentMode,onChange:e=>A((0,n.A)((0,n.A)({},j),{},{paymentMode:e.target.value})),children:[(0,h.jsx)("option",{value:"",children:"--Select--"}),(0,h.jsx)("option",{value:"cash",children:"Cash"}),(0,h.jsx)("option",{value:"bank",children:"Bank"}),(0,h.jsx)("option",{value:"cheque",children:"Cheque"})]})]}),"cash"!==j.paymentMode&&(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-1",children:"Account"}),(0,h.jsx)(c.A,{className:"w-full",data:N,onChange:e=>A((0,n.A)((0,n.A)({},j),{},{account:e})),value:j.account})]})]})]})}),(0,h.jsxs)("div",{className:"content__body__main mt-3",children:[(0,h.jsxs)("table",{className:"w-full border",children:[(0,h.jsx)("thead",{className:"bg-gray-200",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{}),(0,h.jsx)("td",{className:"p-2 font-medium",children:"Date"}),(0,h.jsx)("td",{className:"font-medium",children:"Invoice Number"}),(0,h.jsx)("td",{className:"font-medium",children:"Invoice Amount"}),(0,h.jsx)("td",{className:"font-medium",children:"TDS Amount"})]})}),(0,h.jsx)("tbody",{children:_.length>0?_.map(((e,a)=>(0,h.jsxs)("tr",{className:"border-gray-300",children:[(0,h.jsx)("td",{className:"p-2 max-w-2",children:(0,h.jsx)("input",{type:"checkbox",onChange:a=>((e,a)=>{const{checked:t}=e.target,s=parseInt(a.dueAmount);if(t){if(C<=0)return x("No amount left to allocate","error"),e.preventDefault(),void(e.target.checked=!1);const t=Math.min(C,s),r=[...D,(0,n.A)((0,n.A)({},a),{},{allocated:t})];P(r),S(C-t)}else{const e=D.find((e=>e._id===a._id)),t=D.filter((e=>e._id!==a._id));e&&S(C+e.allocated),P(t)}})(a,e)})}),(0,h.jsx)("td",{children:e.invoiceDate.split("T")[0]}),(0,h.jsx)("td",{children:e.salesInvoiceNumber}),(0,h.jsx)("td",{children:e.dueAmount||0}),(0,h.jsx)("td",{children:e.tdsAmount||0})]},a))):(0,h.jsx)("tr",{className:"text-center",children:(0,h.jsx)("td",{colSpan:5,className:"py-5 text-gray-500 font-bold",children:"No Invoice found"})})})]}),(0,h.jsxs)("div",{className:"w-full flex justify-end gap-3 mt-3",children:[(0,h.jsxs)("button",{onClick:async()=>{if(""===j.party)return x("Please select a party","error");if(""===j.paymentInNumber)return x("Please enter a payment number","error");if(""===j.paymentInDate)return x("Please select a payment date","error");if(""===j.paymentMode)return x("Please select a payment mode","error");if(""===j.account)return x("Please select an account","error");if(D.length<=0)return x("Select invoice","error");try{const e="https://ezy-bill-api.tisindia.net/api/v1/paymentin/add",t=d.A.get("token"),s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a?(0,n.A)((0,n.A)({},j),{},{token:t,update:!0,id:v,checkedInv:D}):(0,n.A)((0,n.A)({},j),{},{token:t,checkedInv:D}))}),r=await s.json();return 200!==s.status||r.err?x(r.err,"error"):a?(x("Payment update successfully","success"),void y(-1)):(k(),x("Payment add successfully","success"),void y("/admin/payment-in"))}catch(e){return console.log(e),x("Something went wrong","error")}},className:"bg-green-500 hover:bg-green-400 save__and__reset__btns",children:[(0,h.jsx)(p.F.CHECK,{}),a?"Update":"Save"]}),(0,h.jsxs)("button",{onClick:k,className:"bg-blue-800 hover:bg-blue-700 save__and__reset__btns",children:[(0,h.jsx)(p.F.RESET,{}),"Reset"]})]})]})]})},f=e=>{let{mode:a}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.A,{title:"Add Payment"}),(0,h.jsxs)("main",{id:"main",children:[(0,h.jsx)(l.A,{}),(0,h.jsx)("div",{className:"content__body",children:(0,h.jsx)(y,{mode:a})})]})]})}},7801:(e,a,t)=>{t.d(a,{A:()=>P});var n=t(53986),s=t(58168),r=t(65043),l=t(75180),c=t(45467),i=t(32949);const o=["timeout","placement"],d=r.forwardRef(((e,a)=>{let{timeout:t=300,placement:d="right"}=e,m=(0,n.A)(e,o);const{propsWithDefaults:u}=(0,i.l)("Slide",m),{prefix:p}=(0,c.U)("anim"),h=p("slide-in",d),y=p("slide-out",d);return r.createElement(l.A,(0,s.A)({},u,{ref:a,animation:!0,timeout:t,enteringClassName:h,enteredClassName:h,exitingClassName:y,exitedClassName:y}))}));d.displayName="Slide";const m=d;var u=t(75105);const p={};function h(e){p[e]||(console.warn(e),p[e]=!0)}h._resetWarned=()=>{for(const e in p)delete p[e]};const y=h;function f(e,a){var t;const n=null!==(t=e.displayName)&&void 0!==t?t:e.name,l=r.forwardRef(((t,n)=>(y(a),r.createElement(e,(0,s.A)({ref:n},t)))));return l.displayName="deprecated(".concat(n,")"),l}var x=t(21569);const v=r.forwardRef(((e,a)=>r.createElement(x.A,(0,s.A)({classPrefix:"drawer-body"},e,{ref:a}))));var j=t(92024);const A=r.forwardRef(((e,a)=>r.createElement(j.A,(0,s.A)({classPrefix:"drawer-header"},e,{ref:a}))));const N=(0,t(43574).a)({name:"DrawerActions"});var g=t(68558);const b=r.forwardRef(((e,a)=>r.createElement(g.A,(0,s.A)({classPrefix:"drawer-footer"},e,{ref:a}))));var w=t(28307);const _=r.forwardRef(((e,a)=>r.createElement(w.A,(0,s.A)({classPrefix:"drawer-title"},e,{ref:a})))),I=["className","placement","classPrefix","animation","closeButton"],D=r.forwardRef(((e,a)=>{const{propsWithDefaults:t}=(0,i.l)("Drawer",e),{className:l,placement:o="right",classPrefix:d="drawer",animation:p=m,closeButton:h=!0}=t,y=(0,n.A)(t,I),{merge:f,prefix:x}=(0,c.U)(d),v=f(l,x(o)),j={placement:o};return r.createElement(u.A,(0,s.A)({},y,{ref:a,overflow:!1,classPrefix:d,className:v,animation:p,animationProps:j,isDrawer:!0,closeButton:h}))}));v.displayName="DrawerBody",A.displayName="DrawerHeader",N.displayName="DrawerActions",b.displayName="DrawerFooter",_.displayName="DrawerTitle",D.Body=v,D.Header=A,D.Actions=N,D.Footer=f(b,"<Drawer.Footer> has been deprecated, use <Drawer.Actions> instead."),D.Title=_,D.displayName="Drawer";const P=D}}]);
//# sourceMappingURL=9664.c6a94df2.chunk.js.map