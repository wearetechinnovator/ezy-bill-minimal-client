"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1141],{55980:(e,t,a)=>{a.d(t,{A:()=>r});a(65043);var n=a(75105),s=a(23930),l=a(83003),i=a(25878),o=a(70579);const r=e=>{let{open:t}=e;const a=(0,l.wA)();return(0,o.jsx)("div",{className:"item__modal",children:(0,o.jsxs)(n.A,{open:t,size:600,onClose:()=>{a((0,i.L)(!1)),window.location.reload()},children:[(0,o.jsx)(n.A.Header,{children:(0,o.jsx)("h6",{className:"py-2",children:"Add Item"})}),(0,o.jsx)(n.A.Body,{children:(0,o.jsx)(s.AddItemComponent,{})})]})})}},19983:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(83003);const s=e=>{const t=(0,n.d4)((e=>e.userDetail)),a=t.activeCompany;if(t.companies)for(let n of t.companies)if(n._id===a)return"invoice"===e?[n.invoiceInitial,n.invoiceNextCount]:"po"===e?[n.poInitial,n.poNextCount]:"proforma"===e?[n.proformaInitial,n.proformaNextCount]:"quotation"===e?[n.quotationInitial,n.quotationCount]:"creditnote"===e?[n.creditNoteInitial,n.creditNoteCount]:"salesreturn"===e?[n.salesReturnInitial,n.salesReturnCount]:"deliverychalan"===e?[n.deliverChalanInitial,n.deliveryChalanCount]:"purchase"===e?[n.purchaseInitial,n.purchaseNextCount]:null}},75532:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(89379),s=a(88918);const l=()=>{const{getApiData:e}=(0,s.A)(),t=(e,t)=>{const a=t[e].tax/100;return((t[e].qun*t[e].price-t[e].discountPerAmount)*a).toFixed(2)};return{onItemChange:async(t,a,n,s,l,i,o)=>{var r;if((null===(r=s[a])||void 0===r?void 0:r.itemId)===t)return;let d=(await e("item")).data.filter((e=>e._id===t));if(d.length>=0){var c,u,x,m,p,h,f,j,g,v,A,y,b,N,w;let e=[...s];console.log("lengthOfItem",e.length);let t=[],i=(null===(c=d[0])||void 0===c||null===(u=c.category)||void 0===u?void 0:u.tax)||(null===(x=d[0])||void 0===x?void 0:x.tax);const r=n.filter(((e,t)=>e._id===i))[0];e[a].itemName=null===(m=d[0])||void 0===m?void 0:m.title,e[a].itemId=null===(p=d[0])||void 0===p?void 0:p._id,e[a].hsn=(null===(h=d[0])||void 0===h||null===(f=h.category)||void 0===f?void 0:f.hsn)||(null===(j=d[0])||void 0===j?void 0:j.hsn),e[a].unit=null===(g=d[0])||void 0===g?void 0:g.unit,e[a].price="sale"===o?null===(v=d[0])||void 0===v?void 0:v.salePrice:null===(A=d[0])||void 0===A?void 0:A.purchasePrice,e[a].selectedUnit=null===(y=d[0])||void 0===y||null===(b=y.unit[0])||void 0===b?void 0:b.unit,e[a].tax=null!==(N=null===r||void 0===r?void 0:r.gst)&&void 0!==N?N:0,null===(w=d[0])||void 0===w||w.unit.forEach(((e,a)=>{t.push(e.unit)})),e[a].unit=[...t],l(e)}},addItem:(e,t,a,s,l,i)=>{1===e?(console.log("itemRowSet",t.length),a((e=>{const a=(0,n.A)((0,n.A)({},t),{},{rowItem:e.length>0?e[e.length-1].rowItem+1:t.rowItem}),l=[...e,a];return s((e=>(0,n.A)((0,n.A)({},e),{},{items:l}))),l}))):i((e=>{const t=(0,n.A)((0,n.A)({},l),{},{additionalRowsItem:e.length>0?e[e.length-1].additionalRowsItem+1:l.additionalRowsItem}),a=[...e,t];return s((e=>(0,n.A)((0,n.A)({},e),{},{additionalCharge:a}))),a}))},deleteItem:(e,t,a,s,l)=>{1===e?a((e=>{const a=e.filter(((e,a)=>a!==t));return s((e=>(0,n.A)((0,n.A)({},e),{},{items:a}))),a})):l((e=>{const a=e.filter(((e,a)=>a!==t));return s((e=>(0,n.A)((0,n.A)({},e),{},{additionalCharge:a}))),a}))},changeDiscountType:(e,t,a,s,l,i)=>{if("no"!==e.target.value){if("before"===e.target.value&&t.some((e=>parseInt(e.discountPerAmount)>0)))return void i("To apply discount before tax, remove discount on item","warning");s((0,n.A)((0,n.A)({},a),{},{discountType:e.target.value})),l(!1)}else s((0,n.A)((0,n.A)({},a),{},{discountType:e.target.value})),s((e=>(0,n.A)((0,n.A)({},e),{},{discountAmount:(0).toFixed(2),discountPercentage:(0).toFixed(2)}))),l(!0)},calculateFinalAmount:function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0",i=0,o=0;if(e.forEach(((e,t)=>{e.amount&&(i+=parseFloat(e.amount))})),"no"===t.discountType||""===t.discountType||"before"===t.discountType?o=a()("amount"):"after"===t.discountType&&(o=(a()("amount")-t.discountAmount).toFixed(2)),n)return isNaN(i)?o:(parseFloat(i)+parseFloat(o)).toFixed(0);{let e=isNaN(i)?o:(parseFloat(i)+parseFloat(o)).toFixed(2);return s&&(e="0"===l?parseFloat(e)-parseFloat(s):parseFloat(e)+parseFloat(s)),e}},onPerDiscountAmountChange:(e,t,a,n,s)=>{let l=[...a],i=parseFloat(l[t].price)*parseFloat(l[t].qun),o=(parseFloat(e)/i*100).toFixed(2);"percentage"===l[t].perDiscountType&&"before"!==s.discountType||(l[t].discountPerAmount=isNaN(e)||0===e?(0).toFixed(2):e,l[t].discountPerPercentage=isNaN(o)?(0).toFixed(2):o),n(l)},onPerDiscountPercentageChange:(e,t,a,n,s)=>{let l=[...a],i=parseFloat(l[t].price)*parseFloat(l[t].qun)/100*e;"amount"===l[t].perDiscountType&&"before"!==s.discountType||(l[t].discountPerPercentage=e,l[t].discountPerAmount=i.toFixed(2)),n(l)},calculatePerTaxAmount:t,calculatePerAmount:(e,a)=>{const n=a[e].qun,s=a[e].price,l=a[e].discountPerAmount;return(parseFloat(n*s-l)+parseFloat(t(e,a))).toFixed(2)},onDiscountAmountChange:(e,t,a,s,l)=>{if(null!==t){let t=((e.target.value||(0).toFixed(2))/l()("amount")*100).toFixed(2);s((0,n.A)((0,n.A)({},a),{},{discountAmount:e.target.value,discountPercentage:t}))}}}}},31141:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var n=a(89379),s=a(65043),l=a(35543),i=a(44074),o=a(75206),r=a(86319),d=a(9435),c=a(88918),u=a(19983),x=a(1880),m=a(66580),p=a(73023),h=a.n(p),f=a(83003),j=a(60309),g=a(55980),v=a(89771),A=a(53435),y=a(75532),b=a(70579);document.title="Proforma";const N=e=>{var t;let{mode:a}=e;const p=(0,d.A)(),{id:N}=(0,m.g)(),w=(0,u.A)("proforma"),{getApiData:P}=(0,c.A)(),F=(0,m.Zp)(),T=((0,f.wA)(),(0,f.d4)((e=>e.partyModalSlice.show))),C=(0,f.d4)((e=>e.itemModalSlice.show)),D={QuotaionItem:1,itemName:"",description:"",hsn:"",qun:"1",unit:[],selectedUnit:"",price:"",discountPerAmount:"",discountPerPercentage:"",tax:"",taxAmount:"",amount:"",perDiscountType:""},S={additionalRowsItem:1,particular:"",amount:""},[_,I]=(0,s.useState)([D]),[O,k]=(0,s.useState)([S]),[q,E]=(0,s.useState)({party:"",proformaNumber:"",estimateDate:(new Date).toISOString().split("T")[0],validDate:"",items:_,additionalCharge:O,note:"",terms:"",discountType:"",discountAmount:"",discountPercentage:"",finalAmount:"",autoRoundOff:!1,roundOffAmount:null,roundOffType:"0"}),[R,U]=(0,s.useState)(null),[z,L]=(0,s.useState)(null),[Q,H]=(0,s.useState)(null),[J,B]=(0,s.useState)(null),[M,Y]=(0,s.useState)(null),[K,V]=(0,s.useState)(!0),[Z,G]=(0,s.useState)([]),[W,X]=(0,s.useState)([]),[$,ee]=(0,s.useState)([]),[te,ae]=(0,s.useState)([]),{onItemChange:ne,addItem:se,deleteItem:le,changeDiscountType:ie,calculateFinalAmount:oe}=(0,y.A)(),re=async()=>{let e;e="edit"===a?"https://ezy-bill-api.tisindia.net/api/v1/proforma/get":"https://ezy-bill-api.tisindia.net/api/v1/quotation/get";const t=x.A.get("token"),s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,id:N})}),l=await s.json(),i=(0,n.A)({},l.data);delete i.quotationNumber;const o=(0,n.A)((0,n.A)({},i),{},{estimateDate:l.data.estimateDate?new Date(l.data.estimateDate).toISOString().split("T")[0]:""});E((e=>(0,n.A)((0,n.A)({},e),o))),k([...l.data.additionalCharge]),I([...l.data.items]),"no"!=l.data.discountType&&V(!1)};(0,s.useEffect)((()=>{N&&re()}),[N]),(0,s.useEffect)((()=>{(async()=>{if(q.party){const{data:e}=await P("party",q.party);Y(e)}})()}),[q.party]),(0,s.useEffect)((()=>{w&&"convert"===a||w&&!a?E((e=>(0,n.A)((0,n.A)({},e),{},{proformaNumber:w[0]+w[1]}))):w&&"edit"===a&&re()}),[null===w||void 0===w?void 0:w.length,a]),(0,s.useState)((()=>{(async()=>{{const e=await P("item");G([...e.data]);const t=e.data.map((e=>({label:e.title,value:e.title})));ee(t)}{const e=await P("tax"),t=e.data.map((e=>({label:e.title,value:e.gst})));X([...e.data]),ae([...t])}})()}),[]),(0,s.useEffect)((()=>{"before"===q.discountType&&_.length>0&&I((e=>e.map((t=>{const a=(parseFloat(q.discountAmount||0)/parseFloat(t.price||0)*100).toFixed(2),s=(parseFloat(q.discountAmount||0)/parseFloat(e.length)).toFixed(2);return(0,n.A)((0,n.A)({},t),{},{discountPerPercentage:a,discountPerAmount:s})}))))}),[q.discountAmount,_.length]);const de=(e,t)=>{let a=[..._],n=parseFloat(a[t].price)*parseFloat(a[t].qun),s=(parseFloat(e)/n*100).toFixed(2);"percentage"===a[t].perDiscountType&&"before"!==q.discountType||(a[t].discountPerAmount=isNaN(e)||0===e?(0).toFixed(2):e,a[t].discountPerPercentage=isNaN(s)?(0).toFixed(2):s),I(a)},ce=(e,t)=>{let a=[..._],n=parseFloat(a[t].price)*parseFloat(a[t].qun)/100*e;"amount"===a[t].perDiscountType&&"before"!==q.discountType||(a[t].discountPerPercentage=e,a[t].discountPerAmount=n.toFixed(2)),I(a)},ue=e=>{const t=_[e].tax/100;return((_[e].qun*_[e].price-_[e].discountPerAmount)*t).toFixed(2)},xe=e=>{const t=_[e].qun,a=_[e].price,n=_[e].discountPerAmount;return(parseFloat(t*a-n)+parseFloat(ue(e))).toFixed(2)};(0,s.useEffect)((()=>{const e=oe(O,q,me,q.autoRoundOff,q.roundOffAmount,q.roundOffType);E((t=>(0,n.A)((0,n.A)({},t),{},{finalAmount:e})))}),[_,O,q.autoRoundOff,q.roundOffAmount,q.roundOffType]);const me=(0,s.useCallback)((()=>e=>{let t=0;return _.forEach(((a,n)=>{"discount"===e?a.discountPerAmount&&(t=(parseFloat(t)+parseFloat(a.discountPerAmount)).toFixed(2)):"tax"===e?t=(parseFloat(t)+parseFloat(ue(n))).toFixed(2):"amount"===e&&(t=(parseFloat(t)+parseFloat(xe(n))).toFixed(2))})),isNaN(t)?0:t}),[_,R,z,Q,J]),pe=()=>{I([D]),k([S]),E({party:"",proformaNumber:w,estimateDate:"",validDate:"",items:_,additionalCharge:O,note:"",terms:"",discountType:"",discountAmount:"",discountPercentage:""})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{title:"edit"===a?"Update Proforma":"Add Proforma"}),(0,b.jsxs)("main",{id:"main",children:[(0,b.jsx)(r.A,{}),(0,b.jsx)(j.A,{open:T}),(0,b.jsx)(g.A,{open:C}),(0,b.jsx)("div",{className:"content__body",children:(0,b.jsxs)("div",{className:"content__body__main bg-white",id:"addQuotationTable",children:[(0,b.jsx)("div",{className:"top__btn__grp",children:(0,b.jsx)("div",{className:"extra__btns",children:"edit"===a&&(0,b.jsxs)("button",{onClick:()=>{h()({title:"Are you sure?",icon:"warning",buttons:!0}).then((e=>{e&&(h()("Proforma successfully duplicate",{icon:"success"}),F("/admin/proforma-invoice/add/".concat(N)))}))},children:[(0,b.jsx)(A.F.COPY,{}),"Duplicate invoice"]})})}),(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-around gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,b.jsxs)("p",{className:"text-xs",children:["Select Party ",(0,b.jsx)("span",{className:"required__text",children:"*"})]}),(0,b.jsx)(v.A,{model:"party",partyType:"customer",onType:e=>{E((0,n.A)((0,n.A)({},q),{},{party:e}))},value:null===(t=q.party)||void 0===t?void 0:t._id})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,b.jsxs)("p",{className:"text-xs",children:["Proforma Number ",(0,b.jsx)("span",{className:"required__text",children:"*"})]}),(0,b.jsx)("input",{type:"text",onChange:e=>E((0,n.A)((0,n.A)({},q),{},{proformaNumber:e.target.value})),value:q.proformaNumber})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,b.jsxs)("p",{className:"text-xs",children:["Proforma Date ",(0,b.jsx)("span",{className:"required__text",children:"*"})]}),(0,b.jsx)("input",{type:"date",onChange:e=>{E((0,n.A)((0,n.A)({},q),{},{estimateDate:e.target.value}))},value:q.estimateDate})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 w-full lg:w-1/3",children:[(0,b.jsx)("p",{className:"text-xs",children:"Valid To"}),(0,b.jsx)("input",{type:"date",onChange:e=>{E((0,n.A)((0,n.A)({},q),{},{validDate:e.target.value}))},value:q.validDate})]})]}),null!==M&&(0,b.jsxs)("div",{className:"text-[10px] mt-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"Phone"}),": ",null===M||void 0===M?void 0:M.contactNumber]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"Address"}),": ",null===M||void 0===M?void 0:M.billingAddress]})]}),(0,b.jsx)("div",{className:"overflow-x-auto rounded",children:(0,b.jsxs)("table",{className:"add__table min-w-full table-style",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{width:"*"},children:"Item"}),(0,b.jsx)("th",{style:{width:"6%"},children:"HSN/SAC"}),(0,b.jsx)("th",{style:{width:"5%"},children:"QTY"}),(0,b.jsx)("th",{style:{width:"7%"},children:"Unit"}),(0,b.jsx)("th",{style:{width:"10%"},children:"Price/Item"}),(0,b.jsx)("th",{style:{width:"10%"},children:"Discount"}),(0,b.jsx)("th",{style:{width:"10%"},children:"Tax"}),(0,b.jsx)("th",{style:{width:"10%"},children:"Amount"}),(0,b.jsx)("th",{style:{width:"3%"}})]})}),(0,b.jsx)("tbody",{children:_.map(((e,t)=>(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)(v.A,{model:"item",onType:e=>ne(e,t,W,_,I,G,"sale"),value:_[t].itemId}),(0,b.jsx)("input",{type:"text",className:"input-style",placeholder:"Description",onChange:e=>{let a=[..._];a[t].description=e.target.value,I(a)},value:_[t].description})]})}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"text",className:"w-[70px] input-style",onChange:e=>{let a=[..._];a[t].hsn=e.target.value,I(a)},value:_[t].hsn})}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"text",className:"input-style",onChange:e=>{let a=[..._];a[t].qun=e.target.value,I(a),B(e.target.value),q.discountType,ce(q.items[t].discountPerPercentage,t),de(q.items[t].discountPerAmount,t)},value:_[t].qun})}),(0,b.jsx)("td",{children:(0,b.jsx)("select",{className:"input-style",onChange:e=>{let a=[..._];a[t].selectedUnit=e.target.value,I(a)},value:_[t].selectedUnit,children:_[t].unit.map(((e,t)=>(0,b.jsx)("option",{value:e,children:e},t)))})}),(0,b.jsx)("td",{align:"center",children:(0,b.jsx)("div",{children:(0,b.jsx)("input",{type:"text",className:"input-style",onChange:e=>{let a=[..._];a[t].price=e.target.value,I(a),U(e.target.value),q.discountType,ce(q.items[t].discountPerPercentage,t),de(q.items[t].discountPerAmount,t)},value:_[t].price})})}),(0,b.jsxs)("td",{children:[" ",(0,b.jsxs)("div",{className:"w-[100px] flex flex-col gap-2 items-center",children:[(0,b.jsxs)("div",{className:"add-table-discount-input",children:[(0,b.jsx)("input",{type:"text",className:"".concat("before"===q.discountType?"bg-gray-100":""," "),onChange:"before"!==q.discountType?e=>{let a=(0,n.A)({},q);a.items[t].perDiscountType="amount",E((0,n.A)({},a)),de(e.target.value,t)}:null,value:_[t].discountPerAmount}),(0,b.jsx)("div",{children:(0,b.jsx)(A.F.RUPES,{})})]}),(0,b.jsxs)("div",{className:"add-table-discount-input",children:[(0,b.jsx)("input",{type:"text",className:"".concat("before"===q.discountType?"bg-gray-100":""," "),onChange:"before"!==q.discountType?e=>{let a=(0,n.A)({},q);a.items[t].perDiscountType="percentage",E((0,n.A)({},a)),ce(e.target.value,t)}:null,value:_[t].discountPerPercentage}),(0,b.jsx)("div",{children:"%"})]})]})]}),(0,b.jsxs)("td",{children:[" ",(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)(l.A,{onChange:e=>{let a=[..._];a[t].tax=e,I(a),L("")},value:_[t].tax,data:te}),(0,b.jsx)("input",{type:"text",onChange:e=>{let a=[..._];a[t].taxAmount=e.target.value,I(a)},value:ue(t)})]})]}),(0,b.jsx)("td",{align:"center",children:(0,b.jsx)("div",{children:(0,b.jsx)("input",{type:"text",value:xe(t),className:"bg-gray-100 custom-disabled",disabled:!0})})}),(0,b.jsx)("td",{align:"center",className:"w-[20px]",children:(0,b.jsx)(A.F.DELETE,{className:"cursor-pointer text-[16px]",onClick:()=>_.length>1&&le(1,t,I,E,k)})})]},e.QuotaionItem)))}),(0,b.jsxs)("tfoot",{children:[(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:9,children:(0,b.jsxs)(i.A,{color:"blue",className:"float-right w-full font-bold",onClick:()=>se(1,D,I,E,S,k),children:[(0,b.jsx)(A.F.ADD_LIST,{className:"text-lg mr-1"}),"Add Item"]})})}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{colSpan:5,align:"right",children:(0,b.jsx)("p",{className:"py-2 font-bold",children:"Sub-Total"})}),(0,b.jsx)("td",{children:me()("discount")}),(0,b.jsx)("td",{children:me()("tax")}),(0,b.jsx)("td",{children:me()("amount")})]})]})]})}),(0,b.jsx)("div",{className:"overflow-x-auto rounded",id:"taxAmountTable",children:(0,b.jsxs)("table",{className:"table-style w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"font-bold",children:"Total Taxable Amount"}),(0,b.jsx)("td",{className:"font-bold",children:"Total Tax Amount"}),(0,b.jsxs)("td",{children:[(0,b.jsx)("span",{className:"font-bold mr-1",children:"Discount Type"}),(0,b.jsx)("span",{children:"(Additional)"})]}),(0,b.jsxs)("td",{children:[(0,b.jsx)("span",{className:"font-bold mr-1",children:"Discount Amount"}),(0,b.jsx)("span",{children:"(Additional)"})]}),(0,b.jsxs)("td",{children:[(0,b.jsx)("span",{className:"font-bold mr-1",children:"Discount Percentage"}),(0,b.jsx)("span",{children:"(Additional)"})]}),(0,b.jsx)("td",{className:"font-bold",children:"Total Amount"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"min-w-[150px]",children:(0,b.jsx)("input",{type:"text",name:"total_taxable_amount",value:(me()("amount")-me()("tax")).toFixed(2),className:"bg-gray-100 custom-disabled",disabled:!0})}),(0,b.jsx)("td",{className:"min-w-[150px]",children:(0,b.jsx)("input",{type:"text",name:"total_tax_amount",value:me()("tax"),className:"bg-gray-100 custom-disabled",disabled:!0})}),(0,b.jsx)("td",{className:"min-w-[180px]",children:(0,b.jsxs)("select",{name:"discount_type",value:q.discountType,onChange:e=>{ie(e,_,q,E,V,p)},children:[(0,b.jsx)("option",{value:"no",children:"No Discount"}),(0,b.jsx)("option",{value:"before",children:"Before Tax"}),(0,b.jsx)("option",{value:"after",children:"After Tax"})]})}),(0,b.jsx)("td",{className:"min-w-[180px]",children:(0,b.jsxs)("div",{className:"add-table-discount-input",children:[(0,b.jsx)("input",{id:"discountAmount",type:"text",className:"".concat(K?"bg-gray-100 custom-disabled":""),disabled:!!K,onChange:e=>K?null:(e=>{if(null!==K){let t=((e.target.value||(0).toFixed(2))/me()("amount")*100).toFixed(2);E((0,n.A)((0,n.A)({},q),{},{discountAmount:e.target.value,discountPercentage:t}))}})(e),value:q.discountAmount}),(0,b.jsx)("div",{children:(0,b.jsx)(A.F.RUPES,{})})]})}),(0,b.jsx)("td",{className:"min-w-[200px]",children:(0,b.jsxs)("div",{className:"add-table-discount-input",children:[(0,b.jsx)("input",{type:"text",id:"discountPercentage",className:"".concat(K?"bg-gray-100 custom-disabled":""),disabled:!!K,onChange:K?null:e=>{let t=(me()("amount")/100*e.target.value).toFixed(2);if(E((0,n.A)((0,n.A)({},q),{},{discountPercentage:e.target.value,discountAmount:t})),"before"===q.discountType){let t=[..._];t.forEach(((t,a)=>{t.discountPerPercentage=e.target.value})),I([...t])}},value:q.discountPercentage}),(0,b.jsx)("div",{children:"%"})]})}),(0,b.jsx)("td",{className:"min-w-[150px]",children:(0,b.jsx)("input",{type:"text",name:"total_amount",className:"bg-gray-100 custom-disabled",disabled:!0,value:me()("amount")})})]})})]})}),(0,b.jsxs)("div",{className:"w-full flex flex-col lg:flex-row justify-between gap-4 mt-3",children:[(0,b.jsxs)("div",{className:"flex flex-col w-full gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{children:"Note: "}),(0,b.jsx)("input",{type:"text",onChange:e=>E((0,n.A)((0,n.A)({},q),{},{note:e.target.value})),value:q.note})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{children:"Terms:"}),(0,b.jsx)("input",{type:"text",onChange:e=>E((0,n.A)((0,n.A)({},q),{},{terms:e.target.value})),value:q.terms})]})]}),(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsx)("div",{className:"uppercase font-bold border border-dashed p-2 rounded",children:"Additional Charges"}),(0,b.jsx)("div",{className:"overflow-x-auto rounded mt-3",id:"addtionalChargeTable",children:(0,b.jsxs)("table",{className:"table-style w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Particular"}),(0,b.jsx)("td",{children:"Amount"}),(0,b.jsx)("td",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:O.map(((e,t)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"text",onChange:e=>{let a=[...O];a[t].particular=e.target.value,k(a)},value:O[t].particular})}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"text",onChange:e=>{let a=[...O];a[t].amount=e.target.value,k(a)},value:O[t].amount})}),(0,b.jsx)("td",{align:"center",children:(0,b.jsx)(A.F.DELETE,{className:"cursor-pointer text-lg",onClick:()=>le(2,t,I,E,k)})})]},e.additionalRowsItem)))}),(0,b.jsx)("tfoot",{children:(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,children:(0,b.jsxs)(i.A,{color:"blue",className:"float-right w-full font-bold",onClick:()=>se(2,D,I,E,S,k),children:[(0,b.jsx)(A.F.ADD_LIST,{className:"text-lg mr-1"}),"Add Item"]})})})})]})}),(0,b.jsxs)("div",{className:"flex justify-between items-center w-full mt-4 round__off__section",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("input",{type:"checkbox",onChange:e=>E((0,n.A)((0,n.A)({},q),{},{autoRoundOff:e.target.checked})),checked:q.autoRoundOff}),(0,b.jsx)("p",{children:"Auto Round Off"})]}),!q.autoRoundOff&&(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center text-sm",children:[(0,b.jsxs)("button",{onClick:()=>{E((0,n.A)((0,n.A)({},q),{},{roundOffType:"1"}))},className:"flex items-center text-[10px] border ".concat("1"===q.roundOffType?"border-blue-700":""," p-[2px]"),children:["Add ",(0,b.jsx)("span",{children:"(+)"})]}),(0,b.jsx)("input",{type:"text",className:"w-[100px]",value:q.roundOffAmount,onChange:e=>E((0,n.A)((0,n.A)({},q),{},{roundOffAmount:e.target.value}))}),(0,b.jsxs)("button",{onClick:()=>{E((0,n.A)((0,n.A)({},q),{},{roundOffType:"0"}))},className:"flex items-center text-[10px] border ".concat("0"===q.roundOffType?"border-blue-700":""," p-[2px]"),children:["Reduce ",(0,b.jsx)("span",{children:"(-)"})]})]})})]}),(0,b.jsx)("p",{className:"font-bold mt-4 mb-2",children:"Final Amount"}),(0,b.jsx)("input",{type:"text",name:"final_amount",className:"bg-gray-100 custom-disabled w-full",disabled:!0,value:q.finalAmount})]})]}),(0,b.jsxs)("div",{className:"w-full flex justify-center gap-3 my-3 mt-5",children:[(0,b.jsxs)("button",{onClick:async()=>{if(""===q.party)return p("Please select party","error");if(""===q.estimateDate)return p("Please enter sales return number","error");if(""===q.proformaNumber)return p("Please enter proforma number","error");for(let t of _){if(""===t.itemName)return p("Please select item","error");if(""===t.qun)return p("Please enter quantity","error");if(""===t.unit)return p("Please select unit","error");if(""===t.price)return p("Please enter price","error")}_.forEach(((e,t)=>{e.taxAmount=ue(t),e.amount=xe(t)})),I([..._]);try{const t="https://ezy-bill-api.tisindia.net/api/v1/proforma/add",s=x.A.get("token"),l=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a&&"edit"===a?(0,n.A)((0,n.A)({},q),{},{token:s,update:!0,id:N}):(0,n.A)((0,n.A)({},q),{},{token:s}))}),i=await l.json();if(200!==l.status||i.err)return p(i.err,"error");if("edit"===a)return p("Proforma update successfully","success"),void F(-1);if("convert"===a)try{const e="https://ezy-bill-api.tisindia.net/api/v1/quotation/add";await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,id:N,update:!0,billStatus:"convert"})})}catch(e){return console.log(e),p("Quotation status not change","error")}return pe(),p("Proforma add successfully","success"),void F("/admin/proforma-invoice")}catch(e){return console.log(e),p("Something went wrong","error")}},className:"add-bill-btn",children:[(0,b.jsx)(A.F.CHECK,{}),a?"Update":"Save"]}),(0,b.jsxs)("button",{className:"reset-bill-btn",onClick:pe,children:[(0,b.jsx)(A.F.RESET,{}),"Reset"]})]})]})})]})]})}}}]);
//# sourceMappingURL=1141.1506bafd.chunk.js.map